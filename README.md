# Телеграм-бот для анализа и прогнозирования временных рядов акций

## Описание проекта
Данный проект представляет собой программное решение для автоматизированного анализа финансовых рынков через интерфейс мессенджера Telegram. Система принимает от пользователя тикер акции и сумму условных инвестиций, загружает исторические данные, проводит обучение ансамбля моделей машинного обучения и формирует прогноз движения цены на 30 дней.

Ключевой особенностью системы является модуль автоматического выбора оптимальной модели (Auto-ML), который сравнивает результаты алгоритмов разной природы (статистические, ансамблевые, нейросетевые) и использует для финального прогноза ту модель, которая показала наименьшую ошибку на тестовой выборке.

## Функциональные возможности

1.  **Сбор данных:** Интеграция с API Yahoo Finance (`yfinance`) для получения исторических котировок (OHLC) за последние 2 года.
2.  **Моделирование и прогнозирование:**
    *   **Random Forest Regressor:** Метод случайного леса с использованием лаговых признаков (Lag Features) для выявления нелинейных зависимостей.
    *   **ARIMA (Auto-Regressive Integrated Moving Average):** Статистическая модель с реализованным алгоритмом автоматического подбора гиперпараметров $(p, d, q)$ на основе тестов на стационарность (ADF) и анализа автокорреляционных функций (ACF/PACF).
    *   **LSTM (Long Short-Term Memory):** Рекуррентная нейронная сеть, оптимизированная для работы с последовательностями и временными рядами.
3.  **Валидация моделей:** Автоматический расчет метрик качества (RMSE, MAPE) на отложенной выборке и выбор наилучшего предиктора.
4.  **Алгоритмический трейдинг:** Модуль анализа прогнозируемого ряда для поиска локальных экстремумов (минимумов и максимумов) с целью формирования сигналов на покупку и продажу.
5.  **Визуализация:** Генерация графиков, совмещающих исторические данные и прогнозные значения.
6.  **Логирование:** Регистрация всех транзакций и результатов работы моделей в локальный файл.

## Структура проекта

*   `main.py`: Основной модуль, реализующий логику бота (Finite State Machine) и обработку команд пользователя.
*   `data_handler.py`: Модуль ETL (Extract, Transform, Load) для загрузки и предобработки финансовых данных.
*   `models.py`: Реализация классов моделей прогнозирования (RandomForest, ARIMA, LSTM).
*   `forecaster.py`: Оркестратор процесса обучения. Отвечает за тренировку, валидацию и выбор лучшей модели.
*   `analysis.py`: Модуль пост-обработки прогноза. Реализует логику поиска точек входа/выхода и расчет ROI.
*   `visualizer.py`: Модуль визуализации данных (Matplotlib).
*   `logger.py`: Система логирования событий.
*   `config.py`: Файл конфигурации (хранение токенов доступа).

## Технологический стек

*   **Язык программирования:** Python 3.8+
*   **Интерфейс:** python-telegram-bot
*   **Анализ данных:** pandas, numpy, scipy
*   **Машинное обучение:** scikit-learn, statsmodels, tensorflow (Keras)
*   **Визуализация:** matplotlib

## Установка и запуск

### 1. Клонирование репозитория
```bash
git clone https://github.com/username/stock-forecast-bot.git
cd stock-forecast-bot
```

### 2. Настройка окружения
Рекомендуется использовать виртуальное окружение:
```bash
python -m venv venv
# Для Windows:
venv\Scripts\activate
# Для Linux/MacOS:
source venv/bin/activate
```

### 3. Установка зависимостей
```bash
pip install -r requirements.txt
```
*Примечание: Файл `requirements.txt` должен содержать: `python-telegram-bot`, `yfinance`, `pandas`, `numpy`, `scikit-learn`, `statsmodels`, `tensorflow`, `matplotlib`, `scipy`.*

### 4. Конфигурация
В файле `config.py` необходимо указать API-токен вашего Telegram-бота:
```python
TELEGRAM_TOKEN = "YOUR_ACCESS_TOKEN"
```

### 5. Запуск
```bash
python main.py
```

## Пример работы системы

**Входные данные:**
*   Тикер: `TSLA`
*   Сумма инвестиций: `1000`

**Результат работы (отчет бота):**
*   **Текущая цена:** $419.40
*   **Прогноз (через 30 дней):** $476.90
*   **Изменение:** +13.71%
*   **Метрики качества:** RMSE: 12.50, MAPE: 2.79%
*   **Стратегия:** Трендовая
*   **Рекомендации:**
    *   Покупка: 26.11.2025 по цене $405.33
    *   Продажа: 25.12.2025 по цене $476.90
*   **Расчетная прибыль:** +$176.57

## Логирование

Система ведет журнал запросов в файле `logs.txt`. Формат записи:
```text
YYYY-MM-DD HH:MM:SS | User: [ID] | Ticker: [SYMBOL] | Sum: [AMOUNT] | Model: [NAME] | RMSE: [VAL] | MAPE: [VAL] | Profit: [VAL]
```

## Отказ от ответственности

Данное программное обеспечение разработано исключительно в образовательных и исследовательских целях. Прогнозы, генерируемые алгоритмами машинного обучения, не являются индивидуальной инвестиционной рекомендацией. Разработчик не несет ответственности за финансовые решения, принятые на основе работы данного бота.
